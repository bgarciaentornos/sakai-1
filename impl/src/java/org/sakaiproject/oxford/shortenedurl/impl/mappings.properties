# url mappings for weblearn to m.ox

# the first section defines the URL pattern from Weblearn, as a regex expression
# the second section defines the resulting URL in m.ox
#
# See: http://download.oracle.com/javase/tutorial/essential/regex/
# Note: For clarity, where values are indeterminate, the expanded character classes have been used [a-A-Z0-9] instead of \\w

########################
# POLLS

# define the patterns
# the first section maps exactly to the first section of the incoming path
poll.pattern.count=2
poll.pattern.1=/poll.json
poll.pattern.2=/poll/[a-zA-Z0-9]+.json

# if values need to be retrieved in the path, at which index in the split string will the value be specified? (0 based)
# path is split on /
# if an extension may be present in that path segment (.json for example), this is stripped so ignore it.
# if multiples, separate by commas
poll.path.values.2=1

# if values need to be retrieved in the query string, which parameter holds them?
# for instance, ?siteId=abc123&userId=def456 and we need userId only, specify userId.
# if multiples, separate by commas.
#xxxx.query.values.x=siteId,userId

# the resulting URL
poll.url.1=/polls/
poll.url.2=/polls/{0}/

# TODO - ideally we'd like to be able to handle complex patterns where something like
# /prefix/123/456.json?userId=abc&siteId=def
# could map to
# /something/siteId/123/userId/456
# ie the order is completely changed.
# for this, I propose changing the path.values and query.values to be a list of maps, like 1=3 or 1:3
# this will allow us to specify which index the original parameter is at, and also which index the parameter should be in the final URL.

########################
# EVALUATIONS

eval-evaluation.pattern.count=2
eval-evaluation.pattern.1=/eval-evaluation/1/summary
eval-evaluation.pattern.2=/eval-evaluation/[a-zA-Z0-9]+

eval-evaluation.path.values.2=1

eval-evaluation.url.1=/surveys/
eval-evaluation.url.2=/surveys/{0}/

########################
# SITES
site.pattern.count=1
site.pattern.1=/site.xml

site.url.1=/sites/

########################
# USERS
user.pattern.count=1
user.pattern.1=/user/current.json

user.url.1=/direct/

########################
# SIGNUPS
signupEvent.pattern.count=3
signupEvent.pattern.1=/signupEvent
signupEvent.pattern.2=/signupEvent/site/[a-zA-Z0-9]+.xml
signupEvent.pattern.3=/signupEvent/[a-zA-Z0-9]+.json?siteId=[a-zA-Z0-9]+

signupEvent.path.values.2=2
signupEvent.path.values.3=1

signupEvent.query.values.x=siteId

signupEvent.url.1=/signups/
signupEvent.url.2=/signups/{0}/
signupEvent.url.3=/signups/{0}/{1}/
