<!DOCTYPE html      PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:rsf="http://ponder.org.uk/rsf" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title rsf:id="modify-template-title">Modify Template</title>
    <link href="/library/skin/tool_base.css" rsf:id="scr=portal-matter" type="text/css" rel="stylesheet" media="all"/>
    <link href="/library/skin/default/tool.css" rsf:id="scr=portal-matter" type="text/css" rel="stylesheet" media="all"/>
    <script type="text/javascript" rsf:id="scr=portal-matter" language="JavaScript" src="/library/js/headscripts.js"></script>
    <link href="../css/evaluation_base.css" type="text/css" rel="stylesheet" media="all" />
    <script type="text/javascript" language="JavaScript" src="../js/selectLink.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/blockUtils.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/jquery.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/form.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/interface/iutil.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/interface/idrag.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/interface/idrop.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/interface/isortables.js"></script>
	
	<script type="text/javascript" language="JavaScript">
		
		var savedList = null;
		
		function saveOrder(form) {
			
			disableOrderButtons();
			
			savedList = new Array();
			
			$("ol.itemList > li").each(
				function(item) {
					savedList.push(this);
				}
			);
			
			$(form).ajaxSubmit();
			
		}
		
		function revertOrder() {
			
			disableOrderButtons();
			
			// iterate through savedList
				// 1. find savedList[i] in itemList (in the DOM)
				// 2. remove item
				// 3. append to bottom of list
			
			for (i in savedList) {
				savedList[i].getElementsByTagName("label")[0].firstChild.nodeValue = new String(parseInt(i) + 1);
				$(savedList[i]).remove().appendTo("div#itemTable > ol#itemList");
			}
			
		}
		
		function enableOrderButtons() {
			document.getElementById("revertOrderButton").disabled = false;
			document.getElementById("saveReorderButton").disabled = false;
		}
		
		function disableOrderButtons() {
			document.getElementById("revertOrderButton").disabled = true;
			document.getElementById("saveReorderButton").disabled = true;
		}
		
	</script>
	
</head>

<body>
<div class="portletBody">

	<div class="navIntraTool">
		<a rsf:id="administrate-toplink" href="administrate.html">Administrate</a>
		<a rsf:id="summary-toplink" href="summary.html">Summary</a>
	</div>

	<div>
	<ul class="breadCrumb">
		<li class="breadCrumb"><a rsf:id="summary-toplink" href="summary.html">Summary</a></li>
		<li class="breadCrumb" rsf:id="modify-template-title">Modify Template</li>				
	</ul>
	</div>
<form rsf:id="modifyForm" name="modify_template_items_form">
<table width="85%" cellpadding="0" cellspacing="0">
<tr>
	<td colspan="2">		
		<a href="preview_eval.html" rsf:id="preview_eval_link" target="_blank">View a preview</a>
		<span rsf:id="preview-eval-desc"> of this template as an evaluation</span>
	</td>
	<td>&nbsp;</td>
	<td align="right"><b><span rsf:id="add-item-note">Add Item:</span></b>
	<select id="itemClassification-selection" rsf:id="itemClassification">
	  <option value="#URL-1">Scaled/Survey</option>
      <option value="#URL-2" selected="selected">Short Answer/Essay</option>
      <option value="#URL-3">Text Header</option>
      <option value="#URL-4">Question Block</option>
      <option value="#URL-5">Expert</option>
	</select>
    <!--  TODO!! Add Javascript to onclick to navigate to selected value -->
	<input rsf:id="add_questions" type="button" value="Add" 
       onclick="EvalSystem.operateSelectLink(this.id, 'itemClassification-selection')"/>
	</td>
</tr>
 <tr>
	<td colspan="2" align="left">
		<a href="#" rsf:id="begin_eval_link">Begin an evaluation using this template</a>
		<span rsf:id="begin-eval-dummylink">Begin an evaluation using this template</span>
	</td>	

	<td>&nbsp;</td>
	<td align="right" style="font-weight:bold;">
  	<span rsf:id="univ-level-header">University Level - </span>
  	<span rsf:id="itemCount">#</span>
  	<span rsf:id="existing-items"> existing items</span></td>
</tr> 
<tr>
	<td colspan="2"><b><label rsf:id="template-title-header">Template Title: </label></b>
  <span rsf:id="title">Title</span></td>
	<td>&nbsp;</td>
	<td align="right"><a href="#" rsf:id="modify_title_desc_link">Modify Template Title/Description</a></td>
</tr>
<tr rsf:id="description-switch:">
	<td colspan="4"><b><label rsf:id="description-header">Description:  </label></b>
   <div style="display:inline" rsf:id="description">Template description goes here, this would be notes for other admins or yourself</div>
   </td>
</tr>  
</table>

</form>

<br/>

<table width="85%" class="sample" cellspacing="0" cellpadding="0">
<tr>
	<td align="left"><span rsf:id="eval-sample">Evaluation: Evaluation title here</span></td>
	<td align="right"><span rsf:id="course-sample">Course: Course title here</span></td>
</tr>
</table>

<br/>

<form rsf:id="modifyFormRows" name="modify_form_rows" method="post">

<input type="button" disabled="true" value="Revert Order" id="revertOrderButton" onclick="revertOrder();" />
<input type="submit" disabled="true" value="Save Order" id="saveReorderButton" rsf:id="saveReorderButton" onclick="saveOrder(this.form); return false;" />

<div id="itemTable">
	<ol id="itemList" class="itemList">
		<li class="itemRow" id="item-row:" rsf:id="item-row:">
			
			<table width="100%">
				<tr>
					
					<td width="5%" class="itemNumCell">
						<span rsf:id="showCB:"><input type="checkbox" rsf:id="blockCheckBox" value="" checked=""/></span>
						<label class="itemNum" id="item-num" rsf:id="item-num">Item Num</label><label>.</label>
					</td>
					
					<td>
						<table width="95%" border="1">
							<tr>
								<td>
									
									<div class="itemFirstLine">
										<input type="hidden" name="hidden-item-num" value="#" id="hidden-item-num" rsf:id="hidden-item-num" />
										<span class="itemDesc">
											<label class="itemClassification" id="item-classification" rsf:id="item-classification">Item Classification</label>
											<label class="scaleDisplay" id="scale-display" rsf:id="scale-display">Scale Display</label>
										</span>
										<span class="itemLink">
											<a href="#" rsf:id="preview-row-item" target="_blank">Preview</a>
										</span>
										<span class="itemLink">
											<a href="#" rsf:id="modify-row-item">Modify</a>
										</span>
										<span class="itemLink">
											<a href="#" rsf:id="remove-row-item">Remove</a>
										</span>
									</div>
									
									<div class="itemSecondLine">
										<span class="itemText">
											<label class="itemText" id="item-text" rsf:id="item-text">Item Text</label>
											<span class="blockItem" id="block-item:" rsf:id="block-item:">
												<br />
												<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>
												<label class="childItemNum" id="child-item-num" rsf:id="child-item-num">Child Item Num</label>.
												<label class="childItemText" id="child-item-text" rsf:id="child-item-text">Child Item Text</label>
											</span>
										</span>
										<span class="scaleDesc">
											<label class="scaleType" id="scale-type" rsf:id="scale-type">Scale Type</label>
											<label class="itemNA" id="item-na" rsf:id="item-na">N/A</label>
										</span>
									</div>
									
								</td>
							</tr>
						</table>
					</td>

				</tr>
			</table>
			
		</li>
	</ol>
</div>

<script type="text/javascript">
	$(document).ready(
		function () {
			
			$("ol.itemList").Sortable(
				{
					accept: 		"itemRow",
					activeclass: 	"sortableactive",
					axis:			"vertically",
					hoverclass: 	"sortablehover",
					helperclass: 	"sorthelper",
					onchange:		function(data) {
										var list = data[0].o.itemList;
										for (i in list) {
											document.getElementById(list[i] + "item-num").firstChild.nodeValue = new String(parseInt(i) + 1);
											document.getElementById(list[i] + "hidden-item-num").value = i;
										}
										enableOrderButtons();
									},
					opacity: 		0.5,
					tolerance:		"intersect"
				}
			);
			
			savedList = new Array();
			
			$("ol.itemList > li").each(
				function(item) {
					savedList.push(this);
				}
			);
			
		}
	);
</script>

</form>

<!--
<form rsf:id="modifyFormRows" name="modify_form_rows" method="post">
<input type="submit" rsf:id="hiddenBtn" id="hiddenBtn" style="visibility:hidden;"/>
	<table width="83%" style="border-collapse: collapse;">
		<tr rsf:id="itemrow:header" id="itemrow:header:0">		
			<td width="15%" class="borderLeft" colspan="2">
            <b><span rsf:id="item-num-header">Item:</span></b> 
  			  <select rsf:id="itemNum" id="itemrow:header:0:itemNum-selection">
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>		
			</select>
			<div rsf:id="showCB:">
            	<input type="checkbox" rsf:id="blockCheckBox" value="" checked="" onclick="countCheckBox();"/>
            </div>
			</td>
			<td width="15%" class="borderLeft" style="font-weight:bold;">
				<label rsf:id="itemClassificationLabel" style="font-weight:bold;">Scale/Survey</label> 
				<label rsf:id="scaleDisplaySetting" style="font-weight:bold;">Compact-Colored</label>		
			</td>
			<td width="10%" class="borderMid">&nbsp;
			</td>
			<td width="10%" class="borderLeft">
				<a href="preview-item.html" rsf:id="preview_row_item" target="_blank">Preview</a>
			</td>
			<td width="10%" class="borderLeft">
				<a href="modify_essay.html" rsf:id="modify_row_item">Modify</a>
			</td>
			<td width="10%" class="borderRight">
				<a href="remove_question.html" rsf:id="remove_row_item">Remove</a>
			</td>		
		</tr>
		
		<tr rsf:id="itemrow:text">
			<td width="3%" valign="top"><label rsf:id="queNo" style="font-weight:bold;">#</label><b>.</b>&nbsp;</td>
			<td rsf:id="itemText" colspan="3" valign="top" width="67%">########</td>
			<td align="center" valign="top" colspan="2" style="font-weight:bold;" width="20%">
				<label rsf:id="scaleType">Agree disagree scale</label>
			</td>
			<td align="right" width="10%" valign="top">
			<div rsf:id="showNA:">
				<input type="radio" rsf:id="itemNA" /><span rsf:id="na-desc">N/A</span>
			</div>
			</td>		
		</tr>
		
		<tr rsf:id="itemrow:blockItems">
			<td width="3%">&nbsp;</td>
			<td colspan="6">&nbsp;&nbsp;&nbsp;
				<label rsf:id="childItemId" style="font-weight:bold;">#</label>.&nbsp;
				<label rsf:id="childItemText">###</label>
			</td>
		</tr>
	</table>

<script rsf:id="decorateSelects">
  EvalSystem.decorateReorderSelects("", 1);
</script>	

</form>
-->

<br/><br/>

<form rsf:id="createBlockForm" name="create_block_form" method="get" target="_self" action="modify_block.html">
	<input type="hidden" name="templateItemIds"/>
	<input rsf:id="createBlockBtn" name="create_block_btn" id="createBlockBtn" type="submit" value="Create Block" disabled="true"
		onclick="javascript: return extractSelectedItems(this);"/>
</form>

</div>
</body>
</html>