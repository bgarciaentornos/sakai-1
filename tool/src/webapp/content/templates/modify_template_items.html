<!DOCTYPE html      PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:rsf="http://ponder.org.uk/rsf" xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title rsf:id="modify-template-title">Modify Template</title>
    <link href="/library/skin/tool_base.css" rsf:id="scr=portal-matter" type="text/css" rel="stylesheet" media="all"/>
    <link href="/library/skin/default/tool.css" rsf:id="scr=portal-matter" type="text/css" rel="stylesheet" media="all"/>
    <script type="text/javascript" rsf:id="scr=portal-matter" language="JavaScript" src="/library/js/headscripts.js"></script>
    <link href="../css/evaluation_base.css" type="text/css" rel="stylesheet" media="all" />
    <script type="text/javascript" language="JavaScript" src="../js/selectLink.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/blockUtils.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/jquery.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/form.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/interface/iutil.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/interface/idrag.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/interface/idrop.js"></script>
	<script type="text/javascript" language="JavaScript" src="../js/jquery/interface/isortables.js"></script>
	
	<script type="text/javascript" language="JavaScript">
		
		var savedList = null;
		
		function saveOrder(form) {
			
			disableOrderButtons();
			
			savedList = new Array();
			
			$("ol.itemList > li").each(
				function(item) {
					savedList.push(this);
				}
			);
			
			$(form).ajaxSubmit();
			
		}
		
		function revertOrder() {
			
			disableOrderButtons();
			
			// iterate through savedList
				// 1. find savedList[i] in itemList (in the DOM)
				// 2. remove item
				// 3. append to bottom of list
			
			savedList.indexOf(','); // ie hack
			
			for (i in savedList) {
				if (i != "indexOf") { // ie hack
					document.getElementById(savedList[i].id + "item-num").firstChild.data = new String(parseInt(i) + 1);
					$(savedList[i]).remove().appendTo("div#itemTable > ol#itemList");
				}
			}
			
		}
		
		function enableOrderButtons() {
			document.getElementById("revertOrderButton").disabled = false;
			document.getElementById("saveReorderButton").disabled = false;
		}
		
		function disableOrderButtons() {
			document.getElementById("revertOrderButton").disabled = true;
			document.getElementById("saveReorderButton").disabled = true;
		}
		
	</script>
	
</head>

<body>
<div class="portletBody">

<div class="navIntraTool"><a rsf:id="administrate-toplink"
	href="administrate.html">Administrate</a> <a rsf:id="summary-toplink"
	href="summary.html">Summary</a></div>

<div>
	<ul class="breadCrumb">
		<li class="breadCrumb"><a rsf:id="summary-toplink" href="summary.html">Summary</a></li>
		<li class="breadCrumb" rsf:id="modify-template-title">Modify Template</li>
	</ul>
</div>

<div style="border:2px solid black; padding:4px; margin:8px;">
	<table width="100%" cellpadding="4" cellspacing="0">
		<tr>
			<td align="left">
				<a rsf:id="preview_eval_link" href="preview_eval.html" target="_blank">View a preview</a>
				<span rsf:id="preview-eval-desc"> of this template as an evaluation</span>
			</td>
			<td align="right">
				<span rsf:id="add-item-note" style="font-weight:bold;">Add Item:</span>
				<form rsf:id="modifyForm" name="modify_template_items_form">
					<select rsf:id="itemClassification"	id="itemClassification-selection">
						<option value="#URL-1" selected="selected">Scaled/Survey</option>
						<option value="#URL-2">Short Answer/Essay</option>
						<option value="#URL-3">Text Header</option>
						<option value="#URL-4">Question Block</option>
						<option value="#URL-5">Expert</option>
					</select>
					<!--  TODO!! Add Javascript to onclick to navigate to selected value -->
					<input rsf:id="add_questions" type="button" value="Add"
						onclick="EvalSystem.operateSelectLink(this.id, 'itemClassification-selection')" />
				</form>
			</td>
		</tr>

		<tr>
			<td align="left">
				<a href="evaluation_start.html" rsf:id="begin_eval_link">Begin an evaluation using this template</a>
				<span rsf:id="begin-eval-dummylink" style="color:gray;"></span>
			</td>
			<td align="right">
				<span rsf:id="level-header">Current Level - # existing items</span>
			</td>
		</tr>

		<tr>
			<td align="left">
				<span rsf:id="template-title-header" style="font-weight:bold;">Template Title:</span>
				<span rsf:id="title">Title</span>
			</td>
			<td align="right">
				<a href="modify_template.html" rsf:id="modify_title_desc_link">Modify Template Title/Description</a>
			</td>
		</tr>

		<tr rsf:id="description-switch:">
			<td colspan="2">
				<span rsf:id="description-header" style="font-weight:bold;">Description:</span>
				<span rsf:id="description">Template description goes here, this would be notes for other admins or yourself,
				Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Vivamus in pede in ligula bibendum tincidunt. 
				Quisque in dui a tellus ultricies posuere. Donec consectetuer, nunc quis luctus dignissim, velit purus 
				consequat eros, eu euismod nibh justo ac purus. Ut sed justo. Cras aliquet massa ut lacus. Vestibulum 
				feugiat vehicula pede. Morbi rhoncus quam in elit. Etiam egestas, metus a volutpat lobortis, erat dui 
				laoreet libero, nec pulvinar sem mi ac felis.</span>
			</td>
		</tr>
	</table>
</div>

<form rsf:id="modifyFormRows" name="modify_form_rows" method="post">

<input type="button" disabled="true" value="Revert Order" id="revertOrderButton" onclick="revertOrder();" />
<input type="submit" disabled="true" value="Save Order" id="saveReorderButton" rsf:id="saveReorderButton" onclick="saveOrder(this.form); return false;" />

<div id="itemTable">
	<ol id="itemList" class="itemList">

		<li rsf:id="item-row:" class="itemRow" id="item-row::1:">
			<input rsf:id="hidden-item-num" type="hidden" name="hidden-item-num" value="1" id="item-row::1:hidden-item-num" />
			<div class="itemLine">
				<label rsf:id="block-check-branch" class="itemCheckbox" for="cb1">
					<input rsf:id="block-checkbox" type="checkbox" onclick="javascript: countCheckBox();" 
						title="Mark item to use in block" id="cb1" />&nbsp;
				</label>
				<span class="itemType">
					<span rsf:id="item-classification" class="itemClassification">Item Classification</span>
					<span rsf:id="scale-display" class="scaleDisplay">- Scale Display Setting</span>
				</span>
				<span class="itemLink">
					<a rsf:id="remove-row-item" href="remove_question.html">Remove</a>
				</span>
				<span class="itemLink">
					<a rsf:id="modify-row-item" href="modify_scaled.html">Modify</a>
				</span>
				<span class="itemLink">
					<a rsf:id="preview-row-item" href="preview_item.html" target="_blank">Preview</a>
				</span>
				<div class="cleaner">&nbsp;</div>
			</div>

			<div class="itemLine2">
				<span class="itemNum"><span rsf:id="item-num" id="item-row::1:item-num">1</span>.&nbsp;</span>
				<span class="itemText">
					<span rsf:id="item-text">Item Text - Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Vivamus in pede in ligula bibendum tincidunt. Quisque in dui a tellus ultricies posuere.</span>
				</span>
				<span class="scaleDesc">
					<span rsf:id="scale-type" style="white-space:nowrap;">Scale Type</span>
					&nbsp;
					<span rsf:id="item-na" style="font-weight:bold;">N/A</span>
				</span>
				<div class="cleaner">&nbsp;</div>
			</div>

			<div rsf:id="block-children:" class="itemLine3">
				<div rsf:id="child-item:" style="margin-left:2em;">
					<span style="font-weight:bold;">
						<span rsf:id="child-item-num">1</span>.
					</span>
					<span rsf:id="child-item-text">Child Item Text - Lorem ipsum dolor sit amet</span>
				</div>
				<div rsf:id="child-item:" style="margin-left:2em;">
					<span style="font-weight:bold;">
						<span rsf:id="child-item-num">2</span>.
					</span>
					<span rsf:id="child-item-text">Child Item Text - Lorem ipsum dolor sit amet</span>
				</div>
				<div rsf:id="child-item:" style="margin-left:2em;">
					<span style="font-weight:bold;">
						<span rsf:id="child-item-num">3</span>.
					</span>
					<span rsf:id="child-item-text">Child Item Text - Lorem ipsum dolor sit amet</span>
				</div>
			</div>
		</li>

		<li rsf:id="item-row:" class="itemRow" id="item-row::2:">
			<input rsf:id="hidden-item-num" type="hidden" name="hidden-item-num" value="2" id="item-row::2:hidden-item-num" />
			<div class="itemLine">
				<label rsf:id="block-check-branch" class="itemCheckbox" for="cb2">
					<input rsf:id="block-checkbox" type="checkbox" onclick="javascript: countCheckBox();" 
						title="Mark item to use in block" id="cb2" />&nbsp;
				</label>
				<span class="itemType">
					<span rsf:id="item-classification" class="itemClassification">Item Classification</span>
					<span rsf:id="scale-display" class="scaleDisplay">- Scale Display Setting</span>
				</span>
				<span class="itemLink">
					<a rsf:id="remove-row-item" href="remove_question.html">Remove</a>
				</span>
				<span class="itemLink">
					<a rsf:id="modify-row-item" href="modify_scaled.html">Modify</a>
				</span>
				<span class="itemLink">
					<a rsf:id="preview-row-item" href="preview_item.html" target="_blank">Preview</a>
				</span>
				<div class="cleaner">&nbsp;</div>
			</div>

			<div class="itemLine2">
				<span class="itemNum"><span rsf:id="item-num" id="item-row::2:item-num">2</span>.&nbsp;</span>
				<span class="itemText">
					<span rsf:id="item-text">Item Text - Lorem ipsum dolor sit amet, consectetuer adipiscing elit. Vivamus in pede in ligula bibendum tincidunt. Quisque in dui a tellus ultricies posuere.</span>
				</span>
				<span class="scaleDesc">
					<span rsf:id="scale-type" style="white-space:nowrap;">Scale Type</span>
					&nbsp;
					<span rsf:id="item-na" style="font-weight:bold;">N/A</span>
				</span>
				<div class="cleaner">&nbsp;</div>
			</div>
		</li>

	</ol>
</div>

<script type="text/javascript">
	$(document).ready(
		function () {
			$("ol.itemList").Sortable(
				{
					accept: 		"itemRow",
					activeclass: 	"sortableactive",
					axis:			"vertically",
					hoverclass: 	"sortablehover",
					helperclass: 	"sorthelper",
					onchange:		function(data) {
										var list = data[0].o.itemList;
										list.indexOf(','); // ie hack
										for (i in list) {
											if (i != "indexOf") { // ie hack
												document.getElementById(list[i] + "item-num").firstChild.data = new String(parseInt(i) + 1);
												document.getElementById(list[i] + "hidden-item-num").value = i;
											}
										}
										enableOrderButtons();
									},
					opacity: 		0.5,
					tolerance:		"intersect"
				}
			);

			savedList = new Array();

			$("ol.itemList > li").each(
				function(item) {
					savedList.push(this);
				}
			);
		}
	);
</script>

</form>

<!--
<form rsf:id="modifyFormRows" name="modify_form_rows" method="post">
<input type="submit" rsf:id="hiddenBtn" id="hiddenBtn" style="visibility:hidden;"/>
	<table width="83%" style="border-collapse: collapse;">
		<tr rsf:id="itemrow:header" id="itemrow:header:0">		
			<td width="15%" class="borderLeft" colspan="2">
            <b><span rsf:id="item-num-header">Item:</span></b> 
  			  <select rsf:id="itemNum" id="itemrow:header:0:itemNum-selection">
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>		
			</select>
			<div rsf:id="showCB:">
            	<input type="checkbox" rsf:id="blockCheckBox" value="" checked="" onclick="countCheckBox();"/>
            </div>
			</td>
			<td width="15%" class="borderLeft" style="font-weight:bold;">
				<label rsf:id="itemClassificationLabel" style="font-weight:bold;">Scale/Survey</label> 
				<label rsf:id="scaleDisplaySetting" style="font-weight:bold;">Compact-Colored</label>		
			</td>
			<td width="10%" class="borderMid">&nbsp;
			</td>
			<td width="10%" class="borderLeft">
				<a href="preview-item.html" rsf:id="preview_row_item" target="_blank">Preview</a>
			</td>
			<td width="10%" class="borderLeft">
				<a href="modify_essay.html" rsf:id="modify_row_item">Modify</a>
			</td>
			<td width="10%" class="borderRight">
				<a href="remove_question.html" rsf:id="remove_row_item">Remove</a>
			</td>		
		</tr>
		
		<tr rsf:id="itemrow:text">
			<td width="3%" valign="top"><label rsf:id="queNo" style="font-weight:bold;">#</label><b>.</b>&nbsp;</td>
			<td rsf:id="itemText" colspan="3" valign="top" width="67%">########</td>
			<td align="center" valign="top" colspan="2" style="font-weight:bold;" width="20%">
				<label rsf:id="scaleType">Agree disagree scale</label>
			</td>
			<td align="right" width="10%" valign="top">
			<div rsf:id="showNA:">
				<input type="radio" rsf:id="itemNA" /><span rsf:id="na-desc">N/A</span>
			</div>
			</td>		
		</tr>
		
		<tr rsf:id="itemrow:blockItems">
			<td width="3%">&nbsp;</td>
			<td colspan="6">&nbsp;&nbsp;&nbsp;
				<label rsf:id="childItemId" style="font-weight:bold;">#</label>.&nbsp;
				<label rsf:id="childItemText">###</label>
			</td>
		</tr>
	</table>

<script rsf:id="decorateSelects">
  EvalSystem.decorateReorderSelects("", 1);
</script>	

</form>
-->

<form rsf:id="createBlockForm" name="create_block_form" method="get" target="_self" action="modify_block.html">
	<input type="hidden" name="templateItemIds"/>
	<input rsf:id="createBlockBtn" name="create_block_btn" id="createBlockBtn" type="submit" value="Create Block" disabled="true"
		onclick="javascript: return extractSelectedItems(this);" style="background-color:#AACCFF;" />
</form>

</div>
</body>
</html>